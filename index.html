<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="./style.css">
        <script type="text/javascript" src="prompt.js"></script>
    </head>
    <body>
        <h1>Lobbyst League</h1>
        <div class="teams"></div>
        <script type="text/javascript">
            let teamTemplate = '';
            let listTemplate = '';
            for (let i = 0; i < 14; i++) {
                listTemplate += `
                            <li></li>
                                `   
            }
            for (let i = 1; i <= 7; i++) {
                teamTemplate += `
                            <div class="team-container" grid-column-start="${i}" grid-column-end="${i}" col="${i}">
                                <h3>Team ${i}</h3>
                                <h3>$</h3>
                                <h3>200</h3>
                                <ul>
                                    ${listTemplate}
                                </ul>
                            </div>
                            `
            }
            let rowTemplate = `
                <div class="row row-one">
                    ${teamTemplate}
                </div>
                <div class="row row-two">
                    ${teamTemplate}
                </div>
            `
            
            document.getElementsByClassName('teams')[0].innerHTML = rowTemplate;
        </script>
        <script type="text/javascript">
            let teams = document.getElementsByClassName('team-container');
            let lastClicked;

            window.addEventListener('message', (e) => {
                let curr = 0;
                let roster = lastClicked.children[3].children;

                while (curr < roster.length) {
                    if (roster[curr].innerHTML === '') {
                        roster[curr].innerHTML = e.data.name;
                        roster[curr].className += e.data.position;
                        lastClicked.children[2].innerHTML = 
                            (parseInt(lastClicked.children[2].innerHTML) - e.data.bid).toString();
                        break;
                    }
                    curr += 1;
                }
            });
            
            const handler = (e) => {
               lastClicked = e.currentTarget;
               let ref = window.open('./prompt.html')
            }
            
            for (let i = 0; i < teams.length; i++) {
                teams[i].addEventListener('click', handler);
            }
        </script>
    </body>
</html>
